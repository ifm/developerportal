<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZ08KXKV1G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ZZ08KXKV1G');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Motion Camera Calibration &mdash; O3R  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/clipboard.min.js"></script>
        <script src="../../../../_static/copybutton.js"></script>
        <script src="../../../../_static/js/versionwarning.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="VPU extrinsic calibration" href="../VPUCalibration/README.html" />
    <link rel="prev" title="Checkerboard Static Camera - Calibration Routine" href="../StaticCameraCalibration/README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> O3R
          </a>
              <div class="version">
                v1.1.30
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../GettingStarted/index_getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Firmware/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../CompatibilityMatrix/compatibility_matrix.html">Compatibility Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Technology/index_hardware_interfaces.html">Technology</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index_software_interfaces.html">Software Interfaces</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../iVA/index_iVA.html">ifm Vision Assistant</a></li>
<li class="toctree-l2"><a class="reference external" href="https://api.ifm3d.com/stable/">ifm3d/ifm3dpy API</a></li>
<li class="toctree-l2"><a class="reference external" href="https://ros.ifm3d.com/latest/">ROS: ifm3d-ros</a></li>
<li class="toctree-l2"><a class="reference external" href="https://ros.ifm3d.com/latest/">ROS2: ifm3d-ros2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Docker/index_docker.html">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ifmDiagnostic/index_diagnostic.html">Diagnostic</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index_toolbox.html">Toolbox</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../IntroToCalibrations/README.html">Introduction to calibrations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Registration2d3d/collect_calibration_data.html">Collect calibration values</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../README.html">Extrinsic calibrations</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../StaticCameraCalibration/README.html">Static camera calibration</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">In motion camera calibration</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l5"><a class="reference internal" href="#tool-description">Tool Description</a></li>
<li class="toctree-l5"><a class="reference internal" href="#procedure">Procedure</a></li>
<li class="toctree-l5"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../VPUCalibration/README.html">VPU calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CameraCalibrationVerification/extrinsic_calibration_verification.html">Calibration verification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Registration2d3d/README.html">2D/3D registration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../AngleConverter/angle_converter.html">Angle conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../H5ToPCDConverter/h5_to_pcd_converter.html">Data conversions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ODS/index_ods.html">ODS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../FAQ/FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../downloadable/index.html">History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">O3R</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../../index_software_interfaces.html">Software Interfaces</a> &raquo;</li>
          <li><a href="../../index_toolbox.html">Toolbox</a> &raquo;</li>
          <li><a href="../README.html">Extrinsic calibration routines: camera to robot coordinates</a> &raquo;</li>
      <li>Motion Camera Calibration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/SoftwareInterfaces/Toolbox/ExtrinsicCalibration/MCC/multi_frame_calibration.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="tex2jax_ignore mathjax_ignore section" id="motion-camera-calibration">
<h1>Motion Camera Calibration<a class="headerlink" href="#motion-camera-calibration" title="Permalink to this headline"></a></h1>
<p>Motion Camera Calibration (MCC) is a tool that allows the roboticist to perform a camera calibration by moving the vehicle to which the camera is mounted.
Based on the design of the relative vehicle trajectory, the rotation angles can be estimated without prior knowledge of the absolute positions with respect to the checkerboard.</p>
<p>This is particularly useful when the final mounting position of the camera is not predetermined and the camera must be moved to different positions and angles between tests.</p>
<p>The application uses the images captured by the camera while the vehicle is moving to determine the 3 rotation parameters of the camera’s extrinsic calibration.</p>
<p>Prerequisites:</p>
<ul class="simple">
<li><p>The O3R camera mounted on the vehicle.</p></li>
<li><p>The vehicle can travel in a straight line in the negative X direction (backwards movement).</p></li>
<li><p>A lapop connected to the VPU of the O3R camera: used to trigger the respective commands for each step of the calibration</p></li>
<li><p>Measurements of the translations of the camera head (<code class="docutils literal notranslate"><span class="pre">transX</span></code>, <code class="docutils literal notranslate"><span class="pre">transY</span></code>, and <code class="docutils literal notranslate"><span class="pre">transZ</span></code> of the <code class="docutils literal notranslate"><span class="pre">extrinsicHeadToUser</span></code> properties). This can be measured manually, or derived from CAD. Note that the camera positions are relative to the center of the rear face of the camera head (see <a class="reference external" href="https://www.ifm.com/us/en/product/O3R222?tab=documents">scale drawings on ifm.com</a>).</p></li>
<li><p>The MCC software package. Currently, this is available upon request from support.robotics&#64;ifm.com.</p></li>
<li><p>A printed calibration checkerboard (exact size: 800 mm by 600 mm) resting on the floor or at a height so that it is in the field of view of the camera being calibrated.
Please find the checkerboard in PDF format <a class="reference download internal" download="" href="../../../../_downloads/139b7a75bb633e5807d823876e59032c/MotionCameraCalibrationTarget_600X800.pdf"><code class="xref download docutils literal notranslate"> <span class="pre">here</span></code></a></p></li>
</ul>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline"></a></h2>
<p>We recommend installing the MCC tool to a fresh Python3 virtual environment to minimize the risk of conflicting versions of dependent Python libraries.</p>
<ol>
<li><p>Create a new virtual environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">venv</span> <span class="n">venv</span>
</pre></div>
</div>
</li>
<li><p>Install the requirements: The required <code class="docutils literal notranslate"><span class="pre">requirements_MCC.txt</span></code> file can be found in the GH repository under <code class="docutils literal notranslate"><span class="pre">ODS/ExtrinsicCalibration/MCC</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">./</span><span class="n">venv</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
<span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements_MCC</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</li>
<li><p>Install the MCC tool: request the download link via email from: from support.robotics&#64;ifm.com</p></li>
<li><p>Start the MCC tool:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">o3r</span><span class="o">-</span><span class="n">extr</span><span class="o">-</span><span class="n">calib</span><span class="o">-</span><span class="n">camera</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="tool-description">
<h2>Tool Description<a class="headerlink" href="#tool-description" title="Permalink to this headline"></a></h2>
<ol class="simple">
<li><p>The MCC application window has 2 parts. <!-- TODO: add UI picture --></p>
<ol class="simple">
<li><p>On the left side, you can:</p>
<ul class="simple">
<li><p>Conﬁgure:</p>
<ul>
<li><p>The ports</p></li>
<li><p>The modes</p></li>
<li><p>The cell size of the checkerboard</p></li>
<li><p>The translation parameters</p></li>
</ul>
</li>
<li><p>Start backward motion / stop backward motion</p></li>
<li><p>Clear and restart the calibration process</p></li>
<li><p>Save / load the data ﬁle</p></li>
</ul>
</li>
<li><p>On the right side, you have two windows:</p>
<ul class="simple">
<li><p>Left window: shows the live stream of the camera,</p></li>
<li><p>Right window: shows the last image that is used for calibration.</p></li>
</ul>
</li>
</ol>
</li>
<li><p>You can calibrate only one camera at a time; therefore select the camera port in the application window which you wish to calibrate.</p></li>
</ol>
</div>
<div class="section" id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="Permalink to this headline"></a></h2>
<ol>
<li><p>Place the target horizontally (if the camera head is mounted horizontally) or vertically (if the camera is mounted vertically) such that the reference corner (bigger cell) is up.</p></li>
<li><p>Type in the camera translations.</p></li>
<li><p>Move the camera closer to the target such that the target is large in the live image: it should at least ﬁll 50% of the image. <!-- TODO: add UI picture --></p></li>
<li><p>Once the checkerboard is detected, the corners will become green indicating that you can start the backward motion.</p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Start</span> <span class="pre">backward</span> <span class="pre">motion</span></code> and move the robot backward in a straight line.<!-- TODO: add diagram--></p>
<ul class="simple">
<li><p>Once you clicked the <code class="docutils literal notranslate"><span class="pre">start</span> <span class="pre">backward</span> <span class="pre">motion</span></code> all other options will be greyed out except <code class="docutils literal notranslate"><span class="pre">Clear</span> <span class="pre">and</span> <span class="pre">Restart</span></code></p></li>
<li><p><strong>The minimum movement range should be <code class="docutils literal notranslate"><span class="pre">50</span> <span class="pre">cm</span></code> (If you moved the robot less than 50 cm then the calibration will not be successful)</strong></p></li>
</ul>
<a class="reference internal image-reference" href="../../../../_images/move_back.gif"><img alt="Drive backwards" class="align-center" src="../../../../_images/move_back.gif" style="width: 400px;" /></a>
</li>
<li><p>The calibration tool will automatically save the frames to a file in the background while you move the robot (camera).</p></li>
<li><p>Once the calibration tool captures the required number of frames, the <code class="docutils literal notranslate"><span class="pre">Stop</span> <span class="pre">backward</span> <span class="pre">motion</span></code> button will be enabled again and can be clicked by the user to terminate this step.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>During the procedure, if you feel you did anything wrong or didn’t move the camera in a straight line click <code class="docutils literal notranslate"><span class="pre">Clear</span> <span class="pre">and</span> <span class="pre">Restart</span></code> to restart the calibration procedure.</p>
</div>
</li>
<li><p>Move the robot orthogonal to the backward motion line and close to the target (ﬁll at least 50% of the image) such that the tool detects all corners of the checkerboard target.</p>
<ul class="simple">
<li><p>The orthogonal offset should be a minimum of 40 cm.</p></li>
</ul>
<a class="reference internal image-reference" href="../../../../_images/capture_frame_1.gif"><img alt="Capture single frame 1" class="align-center" src="../../../../_images/capture_frame_1.gif" style="width: 400px;" /></a>
</li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">single</span> <span class="pre">image</span> <span class="pre">(1/2)</span></code> to add this image to the calibration data file. After clicking the button once, it changes to <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">single</span> <span class="pre">image</span> <span class="pre">(2/2)</span></code> which means the first offset position was successful.</p></li>
<li><p>Move the camera to the other side of the backward motion line and ensure all the checkerboard corners are detected.</p>
<a class="reference internal image-reference" href="../../../../_images/capture-frame-2.gif"><img alt="Capture single frame 2" class="align-center" src="../../../../_images/capture-frame-2.gif" style="width: 400px;" /></a>
</li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">single</span> <span class="pre">image</span> <span class="pre">(2/2)</span></code>.</p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Calibrate</span></code> to perform calibration and output the results.</p></li>
<li><p>The calibration status and parameters will be displayed at the top of the application window.</p>
<p><strong>Optional Steps</strong></p>
</li>
<li><p>Manually save the calibration parameters output (values) to a file for further reference.</p></li>
<li><p>Save the image data file by clicking on the <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">h5</span> <span class="pre">file</span></code> button, this is a handy file to send back to ifm development team for debugging.</p></li>
</ol>
</div>
<div class="section" id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline"></a></h2>
<p>The calibration might not be successful due to the following reasons:</p>
<ul class="simple">
<li><p>Backward motion is not in a straight line.</p></li>
<li><p>If the backward motion path is too short. The minimum path length is 0.4 meters.</p></li>
<li><p>Due to low signal levels in the images. In this case, try calibrating using <code class="docutils literal notranslate"><span class="pre">activeIllumination</span></code> mode.</p></li>
<li><p>If the target is too small in the images. Try to move closer to the checkerboard target.</p></li>
<li><p>If the single images are too close to each other. The offset between the positions of two single images should be at least 0.50 meters.</p></li>
<li><p>If the distance between a single image and the motion path is less than 0.25 meters.</p></li>
</ul>
</div>
</div>


           </div>
          </div>
          
<html>
<head>
 
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="keywords" content="footer, address, phone, icons" />
 
	<title>Footer With Address And Phones</title>
	
	
 
</head>
 
	<body>
		
		<footer class="footer-distributed">
 
		<div class="footer-left">
 
		<p class="footer-links">
		<a href="index.html">Home</a>
	·
		<a href="http://www.o3r.ifm" target="_blank">Learn more</a>
	·
		<a href="../latest/_static/privacy-policy.html" target="_blank">Privacy Policy</a>

		</p>
 
		<p class="footer-company-name">ifm robotics &copy; 2023</p>
		</div>
		
		<div class="footer-center">
 
		<div>
		<i class="fa fa-envelope"></i>
		<p><a href="mailto:support.robotics@ifm.com">support.robotics@ifm.com</a></p>
		</div>
 
		</div>
 
		<div class="footer-right">
 
		<div class="footer-icons">
 
		<a href="https://www.facebook.com/ifmefector" target="_blank"><i class="fa fa-facebook"></i></a>
		<a href="https://twitter.com/ifm_USA" target="_blank"><i class="fa fa-twitter"></i></a>
		<a href="https://www.linkedin.com/showcase/ifm-efector" target="_blank"><i class="fa fa-linkedin"></i></a>
		<a href="https://github.com/ifm" target="_blank"><i class="fa fa-github"></i></a>
 
		</div>
 
		</div>
 
		</footer>
 
	</body>
 
</html>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>