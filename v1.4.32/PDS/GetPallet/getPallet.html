<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>getPallet &mdash; O3R  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=5800d392" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=d9f55abb"></script>
        <script src="../../_static/js/versionwarning.js?v=d4224a34"></script>
        <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <!-- Google tag (gtag.js) -->
    <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZ08KXKV1G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ZZ08KXKV1G');
    </script> -->
     

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            O3R
          </a>
              <div class="version">
                v1.4.32
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GettingStarted/index_getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Firmware/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CompatibilityMatrix/compatibility_matrix.html">Compatibility Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Technology/index_technology.html">Technology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_software_interfaces.html">Software Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CalibrationRoutines/index_calibrations.html">Calibration Routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ODS/index_ods.html">ODS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../FAQ/FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../downloadable/index.html">History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">O3R</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">getPallet</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/PDS/GetPallet/getPallet.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getpallet">
<h1><code class="docutils literal notranslate"><span class="pre">getPallet</span></code><a class="headerlink" href="#getpallet" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">getPallet</span></code> functionality of PDS is designed to detect the position and orientation of up to 10 pallets in the vicinity of autonomous and semi-autonomous pallet handling vehicles. Typically, such a system has a priori knowledge from warehouse management, such as the approximate distance to the pallet and the type of pallet.</p>
<p><code class="docutils literal notranslate"><span class="pre">getPallet</span></code> supports the picking operation by determining the exact location and orientation of the pallet.</p>
<section id="usage-guidelines">
<h2>Usage guidelines<a class="headerlink" href="#usage-guidelines" title="Link to this heading"></a></h2>
<p>The typical use cases for <code class="docutils literal notranslate"><span class="pre">getPallet</span></code> are pallets with two pockets, either with broad blocks or thin stringers as vertical support structures.
<img alt=" Usage" src="../../_images/getPallet_usage.png" /></p>
<p>By default, PDS is able to detect pallets with the following characteristics:</p>
<ul class="simple">
<li><p>For a block-type pallet:</p>
<ul>
<li><p>The pockets should be between 0.24 and 0.44 m,</p></li>
<li><p>The blocks should be between 0.05 and 0.4 m.</p></li>
</ul>
</li>
<li><p>For a stringer-type pallet:</p>
<ul>
<li><p>The pockets should be between 0.4 and 0.48 m,</p></li>
<li><p>The stringers should be between 0.02 and 0.08 m.</p></li>
</ul>
</li>
</ul>
<p>Two pocket pallets with different dimensions than the ones stated above will require specific configuration of the algorithm. Reach out to your ifm representative or to the support team for more details.</p>
</section>
<section id="input">
<h2>Input<a class="headerlink" href="#input" title="Link to this heading"></a></h2>
<p>To execute the <code class="docutils literal notranslate"><span class="pre">getPallet</span></code> command, the <code class="docutils literal notranslate"><span class="pre">command</span></code> parameter of the JSON configuration has to be set to <code class="docutils literal notranslate"><span class="pre">getPallet</span></code>.
Additionally, extra parameters can be provided such as the estimated distance to the pallet, <code class="docutils literal notranslate"><span class="pre">depthHint</span></code>, the type of pallet, <code class="docutils literal notranslate"><span class="pre">palletIndex</span></code>, and the order in which the results should be displayed, <code class="docutils literal notranslate"><span class="pre">palletOrder</span></code>.
An example is provided below in JSON, assuming an instantiated PDS application <code class="docutils literal notranslate"><span class="pre">app0</span></code>.
Note that when using the ifm Vision Assistant, the same structure is reflected in the application parameters.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;applications&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;instances&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;app0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;configuration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;customization&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;getPallet&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="nt">&quot;getPallet&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="nt">&quot;depthHint&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                </span><span class="nt">&quot;palletIndex&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                </span><span class="nt">&quot;palletOrder&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;scoreDescending&quot;</span>
<span class="w">                            </span><span class="p">},</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only the <code class="docutils literal notranslate"><span class="pre">command</span></code> parameter has to be provided. The other parameters are optional.
If they are left blank, the default settings will be used.</p>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">depthHint</span></code></p></td>
<td><p>Approximate distance (in meters along the X axis) between the origin of the calibrated coordinate system and the pallet. Providing an accurate depth hint allows the algorithm to target a specific area of the scene for pallet detection and speeds up processing times. <br>Zero or a negative value can be passed to use automatic distance detection. <strong>Note that automatic detection works best with fully loaded pallets and may fail with empty pallets.</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.5</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">palletIndex</span></code></p></td>
<td><p>Defines the type of pallet to detect. <br>0: block, <br>1: stringer, <br>2: EPAL, side view.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">palletOrder</span></code></p></td>
<td><p>If multiple pallets are detected in the field of view, you can set the order of pallets based on three properties: <br><code class="docutils literal notranslate"><span class="pre">scoreDescending</span></code> (default): the pallet order will be based on the detection score (highest to lowest), corresponding to how well the pallet matches the expected pallet shape; <br><code class="docutils literal notranslate"><span class="pre">zAscending</span></code>/<code class="docutils literal notranslate"><span class="pre">zDescending</span></code>: the pallet order will be based on the height from the floor along the calibrated Z axis (<code class="docutils literal notranslate"><span class="pre">zAscending</span></code>: lower to upper, <code class="docutils literal notranslate"><span class="pre">zDescending</span></code>: upper to lower).</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scoreDescending</span></code></p></td>
</tr>
</tbody>
</table>
<p>The default values for each parameter can be different depending on the firmware version used. We recommend to check the current default, min and max values for each parameter using <a class="reference internal" href="../../Technology/configuration.html#json-schema"><span class="std std-ref">the schema</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Other variants of pallets, having three or more pockets for example, require adjustments of the PDS settings. Reach out to your ifm representative or to the support team for more details.</p>
</div>
</section>
<section id="volumes-of-interest">
<h2>Volumes of interest<a class="headerlink" href="#volumes-of-interest" title="Link to this heading"></a></h2>
<p>When searching for a pallet, the PDS algorithm does not explore the entire space, but focuses the search on two delimited volumes, depending on the case.
This is done to reduce processing time by limiting the search area.
These two volumes are the depth estimation volume, which is only used when using an automatic <code class="docutils literal notranslate"><span class="pre">depthHint</span></code>, and the projection volume.</p>
<p>When using the ifm Vision Assistant, the two volumes can be displayed as shown below, where the green box represents the projection volume and the blue box represents the depth estimation volume.
<img alt="volumes" src="../../_images/pds_volumes_of_interest.png" /></p>
<section id="depth-estimation-volume">
<h3>Depth estimation volume<a class="headerlink" href="#depth-estimation-volume" title="Link to this heading"></a></h3>
<p>The depth estimation volume, <code class="docutils literal notranslate"><span class="pre">depthEstimationVoi</span></code>, defines the volume of interest for automatic depth estimation.
Within this volume, a search will be conducted to estimate the distance of the pallet’s front face from the reference coordinate system.
The default values for depth estimation volume with respect to reference coordinate system are as follows, in meters:</p>
<ul class="simple">
<li><p>X axis: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">3]</span></code></p></li>
<li><p>Y axis: <code class="docutils literal notranslate"><span class="pre">[-0.4,</span> <span class="pre">0.4]</span></code></p></li>
<li><p>Z axis: <code class="docutils literal notranslate"><span class="pre">[-0.1,</span> <span class="pre">0.4]</span></code></p></li>
</ul>
<p>In most cases, we recommend using a predefined depth hint, in which case this volume will not be used.</p>
</section>
<section id="projection-volume">
<h3>Projection volume<a class="headerlink" href="#projection-volume" title="Link to this heading"></a></h3>
<p>The projection volume, <code class="docutils literal notranslate"><span class="pre">projectionVoi</span></code>, defines the volume of interest for detecting the pose of the pallet pockets and center beam.
This volume is centered around the <code class="docutils literal notranslate"><span class="pre">depthHint</span></code>, estimated or provided by the user, which represents the estimated distance to the front face of the pallet.
The default values for the projection volume with respect to the reference coordinate system are as follows, in meters:</p>
<ul class="simple">
<li><p>X axis: <code class="docutils literal notranslate"><span class="pre">[depthHint</span> <span class="pre">-</span> <span class="pre">0.2,</span> <span class="pre">depthHint</span> <span class="pre">+</span> <span class="pre">0.2]</span></code></p></li>
<li><p>Y axis: <code class="docutils literal notranslate"><span class="pre">[-1,</span> <span class="pre">1]</span></code></p></li>
<li><p>Z axis: <code class="docutils literal notranslate"><span class="pre">[-0.6,</span> <span class="pre">0.6]</span></code></p></li>
</ul>
<p>The default values of the projection volume are displayed in the figure below, using the forks coordinates system as a reference.</p>
<p><img alt="projectionVOI" src="../../_images/projectionVOI.drawio.svg" /></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The size of the volumes of interest are protected parameters, which means that they cannot be configured by the user.
The system will display their default values in the output of each result after running the <code class="docutils literal notranslate"><span class="pre">getPallet</span></code> command.
If your application requires different settings, please contact the ifm support team for assistance.</p>
</div>
</section>
</section>
<section id="workflow">
<h2>Workflow<a class="headerlink" href="#workflow" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">getPallet</span></code> command expects the pallet to be in front of the forks and in the field of view of the camera, as illustrated below.</p>
<p><img alt="expected" src="../../_images/expected.drawio.svg" /></p>
<p>The <code class="docutils literal notranslate"><span class="pre">getPallet</span></code> command works as follows:</p>
<ol class="arabic simple">
<li><p>If the <code class="docutils literal notranslate"><span class="pre">depthHint</span></code> is set to a positive value (this is the recommended option), the user is expected to have a priori knowledge about where the pallet is with respect to the forks coordinate system. In this case, the pallet’s pose estimation is performed inside the projection volume, which is set at the <code class="docutils literal notranslate"><span class="pre">depthHint</span></code> including +/- 0.2 m.</p></li>
<li><p>If the <code class="docutils literal notranslate"><span class="pre">depthHint</span></code> is set to zero or a negative value, then the pallet will be searched for in the depth estimation volume. The majority of the pixels inside the depth estimation volume should be on the plane of the front face of the pallet. Once the distance to the pallet is estimated, the projection volume is set at this distance including a +/- 0.2 m buffer in X direction on each side. The pixels in the projection volume will be used to estimate the position of the pallet.</p></li>
</ol>
<p>For further details of a typical <code class="docutils literal notranslate"><span class="pre">getPallet</span></code> trigger sequence see the flowchart below.</p>
<p><img alt="flowchart" src="../../_images/getPallet_flowchart.drawio.svg" /></p>
</section>
<section id="output">
<h2>Output<a class="headerlink" href="#output" title="Link to this heading"></a></h2>
<p>The output of a <code class="docutils literal notranslate"><span class="pre">getPallet</span></code> command is formatted in JSON.
An example JSON result, where the position of one pallet was identified, is shown below:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;getPallet&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;pallet&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;angles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;rotX&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.0016640322282910347</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;rotY&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;rotZ&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.02186517044901848</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;center&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;height&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.10177253931760788</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;position&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.405822515487671</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.08359906077384949</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;z&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.07647071033716202</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;width&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.12625007331371307</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;left&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;height&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.10320165008306503</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;position&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.4106969833374023</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.13937455415725708</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;z&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.07622720301151276</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;width&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.320925772190094</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;right&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;height&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.10034343600273132</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;position&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.4009480476379395</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.30657267570495605</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;z&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.07671421766281128</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;width&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3186997175216675</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9556106328964233</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;depthEstimationVoi&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;xMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;xMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;yMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.4000000059604645</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;yMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.4000000059604645</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;zMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.4000000059604645</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;zMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.10000000149011612</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;projectionVoi&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;xMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.600000023841858</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;xMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1999999284744263</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;yMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;yMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;zMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6000000238418579</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;zMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.6000000238418579</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">},</span>
</pre></div>
</div>
<p>The output has three main components: <code class="docutils literal notranslate"><span class="pre">pallet</span></code>, <code class="docutils literal notranslate"><span class="pre">depthEstimationVoi</span></code> and <code class="docutils literal notranslate"><span class="pre">projectionVoi</span></code>.</p>
<section id="pallet">
<h3><code class="docutils literal notranslate"><span class="pre">pallet</span></code><a class="headerlink" href="#pallet" title="Link to this heading"></a></h3>
<p>This component of the JSON result lists all the detected pallets (up to 10).
For each pallet, the following information is provided:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">angles</span></code></p></td>
<td><p>Rotations components <code class="docutils literal notranslate"><span class="pre">rotX</span></code>, <code class="docutils literal notranslate"><span class="pre">rotY</span></code> and <code class="docutils literal notranslate"><span class="pre">rotZ</span></code> of the pallet, along the three axis of the calibrated coordinate system, in radians.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">center</span></code>, <code class="docutils literal notranslate"><span class="pre">left</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code></p></td>
<td><p>Position and size of the center beam, the left pocket and the right pocket respectively. <br>For each, the width and height is provided, as well as the coordinates of the center of the pocket or beam along the X, Y and Z axis.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">score</span></code></p></td>
<td><p>The score of the pallet. The score corresponds to how well the pallet fits the pallet template. <br>Note that the score does <em>not</em> indicate how well a pallet is detected or whether a pallet is damaged; rather, it shows how closely the pallet matches the model pallet.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Per default the pitch estimation <code class="docutils literal notranslate"><span class="pre">rotY</span></code> is disabled and will always display <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</div>
</section>
<section id="depthestimationvoi-and-projectionvoi">
<h3><code class="docutils literal notranslate"><span class="pre">depthEstimationVoi</span></code> and <code class="docutils literal notranslate"><span class="pre">projectionVoi</span></code><a class="headerlink" href="#depthestimationvoi-and-projectionvoi" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">depthEstimationVoi</span></code> and <code class="docutils literal notranslate"><span class="pre">projectionVoi</span></code> components provide the volumes that were used internally to detect the pallet:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">depthEstimationVoi</span></code></p></td>
<td><p>Volume used in the algorithm to approximate the position of the front face of the pallet.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">projectionVoi</span></code></p></td>
<td><p>Volume where the precise estimation of the positions of the two pockets, the center beam, and the rotation angle was performed. The pixels outside this area are discarded.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="python-example">
<h2>Python example<a class="headerlink" href="#python-example" title="Link to this heading"></a></h2>
<p>To initialize and configure the PDS application to execute the <code class="docutils literal notranslate"><span class="pre">getPallet</span></code> command, please see the code example below.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">getPallet.py</span><a class="headerlink" href="#id1" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1">###########################################</span>
<span class="c1">###2023-present ifm electronic, gmbh</span>
<span class="c1">###SPDX-License-Identifier: Apache-2.0</span>
<span class="c1">###########################################</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Setup:  * Camera: O3R222, 3D on port 2 </span>
<span class="sd">            * orientation: camera horizontally oriented (label up, Fakra cable to the left)</span>
<span class="sd">        * Pallet: pallet in FoV @ 1.5m distance from the camera</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># %%</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">ifm3dpy.device</span> <span class="kn">import</span> <span class="n">O3R</span><span class="p">,</span> <span class="n">Error</span>
<span class="kn">from</span> <span class="nn">ifm3dpy.framegrabber</span> <span class="kn">import</span> <span class="n">FrameGrabber</span><span class="p">,</span> <span class="n">buffer_id</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Device specific configuration</span>
<span class="n">IP</span> <span class="o">=</span> <span class="s2">&quot;192.168.0.69&quot;</span>
<span class="n">CAMERA_PORT</span> <span class="o">=</span> <span class="s2">&quot;port2&quot;</span>
<span class="n">APP_PORT</span> <span class="o">=</span> <span class="s2">&quot;app0&quot;</span>
<span class="n">o3r</span> <span class="o">=</span> <span class="n">O3R</span><span class="p">(</span><span class="n">IP</span><span class="p">)</span>

<span class="c1">############################################</span>
<span class="c1"># Setup the application</span>
<span class="c1">############################################</span>
<span class="c1"># Ensure a clean slate before running the example</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">o3r</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="s2">&quot;/applications/instances&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reset failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Set the extrinsic calibration of the camera</span>
<span class="n">calibration</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;transX&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;transY&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;transZ&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="s2">&quot;rotX&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;rotY&quot;</span><span class="p">:</span> <span class="mf">1.57</span><span class="p">,</span>
    <span class="s2">&quot;rotZ&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.57</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting extrinsic calibration for </span><span class="si">{</span><span class="n">CAMERA_PORT</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">o3r</span><span class="o">.</span><span class="n">set</span><span class="p">({</span><span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">CAMERA_PORT</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;processing&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;extrinsicHeadToUser&quot;</span><span class="p">:</span> <span class="n">calibration</span><span class="p">}}}})</span>

<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating a PDS instance with camera in </span><span class="si">{</span><span class="n">CAMERA_PORT</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">o3r</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;applications&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">APP_PORT</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;pds&quot;</span><span class="p">,</span> <span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">CAMERA_PORT</span><span class="p">],</span> <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;IDLE&quot;</span><span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># %%</span>
<span class="c1">############################################</span>
<span class="c1"># Setup the framegrabber to receive frames</span>
<span class="c1"># when the application is triggered.</span>
<span class="c1">############################################</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">FrameGrabber</span><span class="p">(</span><span class="n">o3r</span><span class="p">,</span> <span class="n">o3r</span><span class="o">.</span><span class="n">port</span><span class="p">(</span><span class="n">APP_PORT</span><span class="p">)</span><span class="o">.</span><span class="n">pcic_port</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">start</span><span class="p">([</span><span class="n">buffer_id</span><span class="o">.</span><span class="n">O3R_RESULT_JSON</span><span class="p">])</span>


<span class="c1"># Define a callback to be executed when a frame is received</span>
<span class="k">def</span> <span class="nf">pallet_callback</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Callback to be executed for each received pallet frame.</span>
<span class="sd">    Retrieve the data from the corresponding buffer and</span>
<span class="sd">    deserialize it into a JSON array.</span>
<span class="sd">    :param frame: the result of the getPallet command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">frame</span><span class="o">.</span><span class="n">has_buffer</span><span class="p">(</span><span class="n">buffer_id</span><span class="o">.</span><span class="n">O3R_RESULT_JSON</span><span class="p">):</span>
        <span class="n">json_chunk</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">get_buffer</span><span class="p">(</span><span class="n">buffer_id</span><span class="o">.</span><span class="n">O3R_RESULT_JSON</span><span class="p">)</span>
        <span class="n">json_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">json_chunk</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="n">json_array</span> <span class="o">=</span> <span class="n">json_array</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
        <span class="n">parsed_json_array</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_array</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detected pallet(s): </span><span class="si">{</span><span class="n">parsed_json_array</span><span class="p">[</span><span class="s1">&#39;getPallet&#39;</span><span class="p">][</span><span class="s1">&#39;pallet&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="n">fg</span><span class="o">.</span><span class="n">on_new_frame</span><span class="p">(</span><span class="n">pallet_callback</span><span class="p">)</span>

<span class="c1">############################################</span>
<span class="c1"># Trigger the getPallet command</span>
<span class="c1">############################################</span>

<span class="c1"># Provide the estimated distance to the pallet and the pallet type.</span>
<span class="n">GET_PALLET_PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;depthHint&quot;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span>  <span class="c1"># We recommend providing a depth hint for faster detections</span>
    <span class="s2">&quot;palletIndex&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Block Pallet/EPAL pallet</span>
<span class="p">}</span>

<span class="c1"># %%</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Triggering the getPallet command&quot;</span><span class="p">)</span>
<span class="n">o3r</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;applications&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">APP_PORT</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;configuration&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;customization&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;getPallet&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;getPallet&quot;</span><span class="p">:</span> <span class="n">GET_PALLET_PARAMETERS</span><span class="p">,</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="c1"># Sleep to ensure we have time to execute the callback before exiting.</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># %%</span>
<span class="n">fg</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          
<html>
<head>
 
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="keywords" content="footer, address, phone, icons" />
 
	<title>Footer With Address And Phones</title>
	
	
 
</head>
 
	<body>
		
		<footer class="footer-distributed">
 
		<div class="footer-left">
 
		<p class="footer-links">
		<a href="index.html">Home</a>
	·
		<a href="http://www.o3r.ifm" target="_blank">Learn more</a>
	·
		<a href="/latest/_static/privacy-policy.html" target="_blank">Privacy Policy</a>

		</p>
 
		<p class="footer-company-name">ifm robotics &copy; 2023</p>
		</div>
		
		<div class="footer-center">
 
		<div>
		<i class="fa fa-envelope"></i>
		<p><a href="mailto:support.efector.object-ident@ifm.com">support.efector.object-ident@ifm.com</a></p>
		</div>
 
		</div>
 
		<div class="footer-right">
 
		<div class="footer-icons">
 
		<a href="https://www.facebook.com/ifmefector" target="_blank"><i class="fa fa-facebook"></i></a>
		<a href="https://twitter.com/ifm_USA" target="_blank"><i class="fa fa-twitter"></i></a>
		<a href="https://www.linkedin.com/showcase/ifm-efector" target="_blank"><i class="fa fa-linkedin"></i></a>
		<a href="https://github.com/ifm" target="_blank"><i class="fa fa-github"></i></a>
 
		</div>
 
		</div>
 
		</footer>
 
	</body>
 
</html>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>