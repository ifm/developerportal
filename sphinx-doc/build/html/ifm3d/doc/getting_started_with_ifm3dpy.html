<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to get started with the ifm3dpy &mdash; O3R  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> O3R
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/O3R/README.html">O3R</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx/content/installation_instructions.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx/cli_link.html">Command Line tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx/python_api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx/cpp_api/annotated.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx/index.html">Indices and tables</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">O3R</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>How to get started with the ifm3dpy</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/ifm3d/doc/getting_started_with_ifm3dpy.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="how-to-get-started-with-the-ifm3dpy">
<h1>How to get started with the ifm3dpy<a class="headerlink" href="#how-to-get-started-with-the-ifm3dpy" title="Permalink to this headline"></a></h1>
<p>At the end of this ‘how to’, you should be able to receive images and know the basic usage of the O3RCamera(), FrameGrabber() and ImageBuffer(). This document is only scratching on the surface of the O3R and the ifm3dpy. Please refer to the other documentation for in depth information.</p>
<section id="first-install-ifm3dpy">
<h2>First: install ifm3dpy<a class="headerlink" href="#first-install-ifm3dpy" title="Permalink to this headline"></a></h2>
<p>You can use the ifm3dpy PyPI package for an easy installation.</p>
<p><em>NOTE: The ifm3d is also available for C++</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install ifm3dpy
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Looking in indexes: https://nexus.intra.ifm/repository/pypi_python_org/simple
Requirement already satisfied: ifm3dpy in /home/devoegse/Git/ifm3d/venv/lib/python3.8/site-packages (0.91.0)
</pre></div>
</div>
</section>
<section id="import-ifm3d">
<h2>Import ifm3d<a class="headerlink" href="#import-ifm3d" title="Permalink to this headline"></a></h2>
<p>Let’s start with importing ifm3d (for python called ifm3dpy)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ifm3dpy</span> <span class="kn">import</span> <span class="n">O3RCamera</span><span class="p">,</span> <span class="n">FrameGrabber</span><span class="p">,</span> <span class="n">ImageBuffer</span>
</pre></div>
</div>
</section>
<section id="device-framegrabber-and-imagebuffer">
<h2>Device, FrameGrabber and ImageBuffer<a class="headerlink" href="#device-framegrabber-and-imagebuffer" title="Permalink to this headline"></a></h2>
<p>ifm3dTiny provides three objects:</p>
<ul class="simple">
<li><p>Device holds the configuration of the camera head, handles the connection and sets the camera in the proper state (RUN or CONF);</p></li>
<li><p>FrameGrabber receives frames (images);</p></li>
<li><p>ImageBuffer stores the image data.</p></li>
</ul>
<p>Instantiating these objects is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">IP</span> <span class="o">=</span> <span class="s1">&#39;192.168.0.69&#39;</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">50012</span>
<span class="n">o3r</span> <span class="o">=</span> <span class="n">O3RCamera</span><span class="p">(</span><span class="n">IP</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">FrameGrabber</span><span class="p">(</span><span class="n">cam</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ImageBuffer</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="receiving-an-image">
<h2>Receiving an image<a class="headerlink" href="#receiving-an-image" title="Permalink to this headline"></a></h2>
<p>You just need to call the function ‘wait_for_frame()’ from the FrameGrabber, provided with an image buffer and a timeout (in seconds). Be aware, that you can only receive an image if the connected head(s) are in “RUN” mode.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">110</span> <span class="c1">#ms</span>
<span class="n">fg</span><span class="o">.</span><span class="n">wait_for_frame</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">timeout</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
<p>Afterwards - expecting you received an image - you can call functions from the ‘ImageBuffer()’ to get to some of the data directly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">amp</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">amplitude_image</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">amp</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s2"> ... </span><span class="si">{</span><span class="n">amp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------

RuntimeError                              Traceback (most recent call last)

/tmp/ipykernel_46778/969249777.py in &lt;module&gt;
----&gt; 1 amp = im.amplitude_image()
      2 print(f&quot;{amp[0][:10]} ... {amp[0][-10:]}&quot;)


RuntimeError: cannot convert due to type or channel mistmatch
</pre></div>
</div>
</section>
<section id="display-the-image">
<h2>Display the image<a class="headerlink" href="#display-the-image" title="Permalink to this headline"></a></h2>
<p>An easy way for displaying the image (without an viewer like the ifmVisionAssistant or RVIZ) is matplot.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install matplotlib
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Looking in indexes: https://nexus.intra.ifm/repository/pypi_python_org/simple
Collecting matplotlib
  Using cached https://nexus.intra.ifm/repository/pypi_python_org/packages/matplotlib/3.4.3/matplotlib-3.4.3-cp38-cp38-manylinux1_x86_64.whl (10.3 MB)
Collecting pillow&gt;=6.2.0
  Using cached https://nexus.intra.ifm/repository/pypi_python_org/packages/pillow/8.3.2/Pillow-8.3.2-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.0 MB)
Collecting numpy&gt;=1.16
  Using cached https://nexus.intra.ifm/repository/pypi_python_org/packages/numpy/1.21.2/numpy-1.21.2-cp38-cp38-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (15.8 MB)
Collecting cycler&gt;=0.10
  Using cached https://nexus.intra.ifm/repository/pypi_python_org/packages/cycler/0.10.0/cycler-0.10.0-py2.py3-none-any.whl (6.5 kB)
Collecting kiwisolver&gt;=1.0.1
  Using cached https://nexus.intra.ifm/repository/pypi_python_org/packages/kiwisolver/1.3.2/kiwisolver-1.3.2-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.whl (1.2 MB)
Requirement already satisfied: python-dateutil&gt;=2.7 in /home/devoegse/Git/ifm3d/venv/lib/python3.8/site-packages (from matplotlib) (2.8.2)
Collecting pyparsing&gt;=2.2.1
  Using cached https://nexus.intra.ifm/repository/pypi_python_org/packages/pyparsing/2.4.7/pyparsing-2.4.7-py2.py3-none-any.whl (67 kB)
Requirement already satisfied: six in /home/devoegse/Git/ifm3d/venv/lib/python3.8/site-packages (from cycler&gt;=0.10-&gt;matplotlib) (1.16.0)
Installing collected packages: pyparsing, pillow, numpy, kiwisolver, cycler, matplotlib
Successfully installed cycler-0.10.0 kiwisolver-1.3.2 matplotlib-3.4.3 numpy-1.21.2 pillow-8.3.2 pyparsing-2.4.7
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">showImage</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>        
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>We can now diplay the image easily with the above function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">showImage</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">amplitude_image</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="change-configuration">
<h2>Change configuration<a class="headerlink" href="#change-configuration" title="Permalink to this headline"></a></h2>
<p>The whole configuration of the O3R is done via json strings. You can use <code class="docutils literal notranslate"><span class="pre">ifm3dpy</span></code> and the <code class="docutils literal notranslate"><span class="pre">O3RCamera</span></code>-object to receive/forward this json configurations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="n">o3r</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------

RuntimeError                              Traceback (most recent call last)

/tmp/ipykernel_46778/1406448996.py in &lt;module&gt;
----&gt; 1 config = o3r.get()


RuntimeError: Lib: XMLRPC Timeout - can you `ping&#39; the sensor?
</pre></div>
</div>
<p>As an example, we change one parameter. In this case the exposure time (expLong/expShort).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;ports&#39;</span><span class="p">][</span><span class="s1">&#39;port2&#39;</span><span class="p">][</span><span class="s1">&#39;acquisition&#39;</span><span class="p">][</span><span class="s1">&#39;exposureLong&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">config</span><span class="p">[</span><span class="s1">&#39;ports&#39;</span><span class="p">][</span><span class="s1">&#39;port2&#39;</span><span class="p">][</span><span class="s1">&#39;acquisition&#39;</span><span class="p">][</span><span class="s1">&#39;exposureShort&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">200</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

/tmp/ipykernel_46778/3973814803.py in &lt;module&gt;
----&gt; 1 config[&#39;ports&#39;][&#39;port2&#39;][&#39;acquisition&#39;][&#39;exposureLong&#39;] = 2000
      2 config[&#39;ports&#39;][&#39;port2&#39;][&#39;acquisition&#39;][&#39;exposureShort&#39;] = 200


NameError: name &#39;config&#39; is not defined
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">o3r</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

/tmp/ipykernel_46778/3382604224.py in &lt;module&gt;
----&gt; 1 o3r.set(config)


NameError: name &#39;config&#39; is not defined
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, ifm CSR.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>