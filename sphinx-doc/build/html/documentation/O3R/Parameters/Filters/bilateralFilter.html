<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adaptive noise bilateral filter &mdash; O3R  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> O3R
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">O3R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/content/installation_instructions.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/cli_link.html">Command Line tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/python_api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/cpp_api/annotated.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/index.html">Indices and tables</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">O3R</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Adaptive noise bilateral filter</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/documentation/O3R/Parameters/Filters/bilateralFilter.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="adaptive-noise-bilateral-filter">
<h1>Adaptive noise bilateral filter<a class="headerlink" href="#adaptive-noise-bilateral-filter" title="Permalink to this headline"></a></h1>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline"></a></h2>
<p>The O3R software allows for filtering the distance measurement in the spatial domain. The spatial domain of a 3D image can be thought of as the local neighborhood of a pixel, that is, the neighboring pixels X-, Y-, and Z-coordinates. Radial distance information for a pixel is combined with its neighbors’ information to form a new distance image with reduced noise.</p>
<p>The bilateral filter is the preferred spatial filter and is enabled by default. It can be applied with different filter mask sizes, which can be set via the parameter <code class="docutils literal notranslate"><span class="pre">anfFilterSizeDiv2</span></code>. Larger filter mask sizes allow for stronger noise reduction.</p>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline"></a></h2>
<p>This distance bilateral filter is, in its concept, highly similar to a <a class="reference external" href="https://en.wikipedia.org/wiki/Bilateral_filter">bilateral filter applied to RGB 2D images</a>. A bilateral filter is a nonlinear edge-preserving smoothing filter. The idea is to replace the pixel value with a weighted average of the information from nearby pixels. The weighting is a combination of the spatial kernel and the range kernel. The O3R implementation additionally incorporates the distance noise estimation for calculating the filter weights.</p>
<blockquote>
<div><p>Note: The weighted average is computed by convolution over the spatial domain. The convolution of the original image and the filter mask returns an image reduced by half the filter size at each image border; that is, with a filter mask of 7x7 pixels, the image is stripped of 7 pixels vertically and horizontally (these pixels are marked as invalid).</p>
</div></blockquote>
<p>The bilateral filter is controlled by the parameter <code class="docutils literal notranslate"><span class="pre">anfFilterSizeDiv2</span></code> (turn it off with <code class="docutils literal notranslate"><span class="pre">anfFilterSizeDiv2</span> <span class="pre">=</span> <span class="pre">0</span></code>). <code class="docutils literal notranslate"><span class="pre">anfFilterSizeDiv2</span> <span class="pre">=</span> <span class="pre">3</span></code> sets the filter mask size to a local 7x7 pixel neighborhood.</p>
<blockquote>
<div><p>Note: The bilateral filter is preferred over the <a class="reference internal" href="median.html"><span class="doc std std-doc">median filter</span></a> because it preserves edge and corner information better (the median filter tends to <em>round</em> corners). It is also possible to apply the bilateral filter with larger filter masks (up to 7x7 pixel masks) compared to 5x5 pixel masks for the median filter. The size of the mask defines how many neighboring pixels are considered when computing a pixel’s value.</p>
</div></blockquote>
<p>Invalid pixels will be ignored during the filtering process and therefore have no impact on the surrounding pixels. Invalid pixels will remain invalid after the filtering.</p>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline"></a></h3>
<p>The following pictures give an overview of the capabilities of spatial filtering with the bilateral filter for different filter mask sizes. All other filters (<a class="reference internal" href="temporalFilter.html"><span class="doc std std-doc">temporal</span></a> and <a class="reference internal" href="median.html"><span class="doc std std-doc">median</span></a>) are deactivated for the purpose of illustrating the bilateral filter’s effect. The maximum allowed distance noise is set at 0.2 m for all images. Note that for maximum distance noise values below 0.2 m the point cloud becomes extremely sparse for smaller filter mask sizes (not shown in the following).</p>
<p>The scene shows a view of our lab, containing various typical objects including a black tote in the center of the room. It is a static scene, which makes it simpler to illustrate the filter’s effect, but these settings (active bilateral filter and inactive temporal filter) are typical for scenes involving motion. Have a look specifically at the distance noise images in the following table. We can see that the distance noise greatly reduces as the filter mask size increases (the color red denotes negligible noise, whereas blue represents noise of around 1 cm and above).</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Bilateral filter mask size</p></th>
<th class="head"><p>Point cloud</p></th>
<th class="head"><p>Distance (top left), amplitude (top right), distance noise (bottom left), and reflectivity images (bottom right)</p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 (filter disabled)</p></td>
<td><p><img alt="anfFilterSizeDiv2_0_value" src="../../../../_images/anfFilterSizeDiv2_0.png" /></p></td>
<td><p><img alt="anfFilterSizeDiv2_0_value" src="../../../../_images/anfFilterSizeDiv2_0_imgs.png" /></p></td>
<td><p><img alt="Color bar" src="../../../../_images/color_bar_noise.png" /></p></td>
</tr>
<tr class="row-odd"><td><p>1 (3x3 mask size)</p></td>
<td><p><img alt="anfFilterSizeDiv2_1_value" src="../../../../_images/anfFilterSizeDiv2_1.png" /></p></td>
<td><p><img alt="anfFilterSizeDiv2_1_value" src="../../../../_images/anfFilterSizeDiv2_1_imgs.png" /></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>2 (5x5 mask size)</p></td>
<td><p><img alt="anfFilterSizeDiv2_2_value" src="../../../../_images/anfFilterSizeDiv2_2.png" /></p></td>
<td><p><img alt="anfFilterSizeDiv2_2_value" src="../../../../_images/anfFilterSizeDiv2_2_imgs.png" /></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>3 (7x7 mask size)</p></td>
<td><p><img alt="anfFilterSizeDiv2_3_value" src="../../../../_images/anfFilterSizeDiv2_3.png" /></p></td>
<td><p><img alt="anfFilterSizeDiv2_3_value" src="../../../../_images/anfFilterSizeDiv2_3_imgs.png" /></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>Note: distance information for the black tote in the middle of the image remains extremely hard to compute even with a <em>strong</em> lateral filtering. For better handling of dark objects, have a look at the <a class="reference internal" href="minAmplitude.html"><span class="doc std std-doc">minimum amplitude</span></a>, <a class="reference internal" href="maxDistNoise.html"><span class="doc std std-doc">maximum distance noise</span></a>, and <a class="reference internal" href="temporalFilter.html"><span class="doc std std-doc">temporal filter</span></a>).</p>
</div></blockquote>
</section>
<section id="scenes-involving-motion">
<h3>Scenes involving motion<a class="headerlink" href="#scenes-involving-motion" title="Permalink to this headline"></a></h3>
<p>The spatial filtering can be performed in scenes where motion is present: only the parts of the images that are not affected by movement will be filtered. This differentiation is possible because the detection of motion is performed before the spatial filter in the processing pipeline. It is perfectly fine and encouraged to use large filter mask sizes.</p>
<blockquote>
<div><p>Note: this is not true for <a class="reference internal" href="temporalFilter.html"><span class="doc std std-doc">temporal filtering</span></a>, which is not best suited to in-motion cases.</p>
</div></blockquote>
</section>
</section>
<section id="related-topics">
<h2>Related topics<a class="headerlink" href="#related-topics" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="median.html"><span class="doc std std-doc">Median filter</span></a></p></li>
<li><p><a class="reference internal" href="temporalFilter.html"><span class="doc std std-doc">Temporal filter</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, ifm CSR.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>