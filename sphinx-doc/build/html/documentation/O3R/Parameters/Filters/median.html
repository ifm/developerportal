<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>(Spatial) Median Filter &mdash; O3R  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> O3R
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">O3R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/content/installation_instructions.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/cli_link.html">Command Line tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/python_api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/cpp_api/annotated.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ifm3d/doc/sphinx/index.html">Indices and tables</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">O3R</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>(Spatial) Median Filter</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/documentation/O3R/Parameters/Filters/median.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="spatial-median-filter">
<h1>(Spatial) Median Filter<a class="headerlink" href="#spatial-median-filter" title="Permalink to this headline"></a></h1>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline"></a></h2>
<p>The O3R software supports two spatial filters for improving the distance measurements: the median filter and the <a class="reference internal" href="bilateralFilter.html"><span class="doc std std-doc">bilateral filter</span></a>.<br />
<strong>We recommend using the bilateral filter in most cases instead of the median filter because the median filter can have undesirable side effects.</strong></p>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline"></a></h2>
<p>The median filter is conceptually very similar to a <a class="reference external" href="https://en.wikipedia.org/wiki/Median_filter">median filter applied to RGB 2D images</a>. A median filter is a nonlinear, edge-preserving smoothing filter. It can be thought of as a filter that replaces the value per pixel with the median value of neighboring pixels. The computation is achieved by sliding the filter mask in the spatial domain until it covers the whole image.
This filtering technique is robust (i.e., not affected by outliers) and reduces noise while keeping edge information intact.
The median filter is applied to the distance image. The distance noise is lowered to heuristically reflect the new noise in the distance image.</p>
<p>The median filter is controlled by the parameter <code class="docutils literal notranslate"><span class="pre">medianSizeDiv2</span></code>; turn it off with
<code class="docutils literal notranslate"><span class="pre">medianSizeDiv2</span> <span class="pre">=</span> <span class="pre">0</span></code>.
<code class="docutils literal notranslate"><span class="pre">medianSizeDiv2</span> <span class="pre">=</span> <span class="pre">1</span></code> sets the filter mask size to a size of 3 x 3 pixels.
<code class="docutils literal notranslate"><span class="pre">medianSizeDiv2</span> <span class="pre">=</span> <span class="pre">2</span></code> is the highest allowed value. It represents a filter mask size of 5 x 5 pixels.
Using larger filter mask sizes combines more pixels’ distance measurements into the filterer value. The filter’ effect will be stronger, resulting in a <em>smoother</em> image.</p>
<blockquote>
<div><p>Note: Invalid pixels are ignored during the filtering process and therefore have no impact on their surrounding pixels. Invalid pixels remain invalid after the filtering.</p>
</div></blockquote>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline"></a></h2>
<p>Below are images of the same scene with different settings for the median filter. Look more specifically at the distance noise image that shows the amount of noise in the scene—the larger the filter mask size, the lower the noise level. The color red corresponds to negligible noise levels and blue to noise around 1 cm and above. See the <a class="reference internal" href="bilateralFilter.html"><span class="doc std std-doc">bilateral filter</span></a> example for comparison with the same scene.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Filter mask size <code class="docutils literal notranslate"><span class="pre">medianSizeDiv2</span></code></p></th>
<th class="head"><p>Point cloud</p></th>
<th class="head"><p>Distance (top left), amplitude (top right), distance noise (bottom left), and reflectivity (bottom right) images</p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 (filter deactivated)</p></td>
<td><p><img alt="medianSizeDiv2_0_value" src="../../../../_images/medianSizeDiv2_0.png" /></p></td>
<td><p><img alt="medianSizeDiv2_0_value" src="../../../../_images/medianSizeDiv2_0_imgs.png" /></p></td>
<td><p><img alt="color bar for noise image" src="../../../../_images/color_bar_noise.png" /></p></td>
</tr>
<tr class="row-odd"><td><p>1 (3 x 3 mask size)</p></td>
<td><p><img alt="medianSizeDiv2_1_value" src="../../../../_images/medianSizeDiv2_1.png" /></p></td>
<td><p><img alt="medianSizeDiv2_0_value" src="../../../../_images/medianSizeDiv2_1_imgs.png" /></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>2 (5 x 5 mask size)</p></td>
<td><p><img alt="medianSizeDiv2_2_value" src="../../../../_images/medianSizeDiv2_2.png" /></p></td>
<td><p><img alt="medianSizeDiv2_0_value" src="../../../../_images/medianSizeDiv2_2_imgs.png" /></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="bilateral-vs-median-filtering">
<h2>Bilateral vs. median filtering<a class="headerlink" href="#bilateral-vs-median-filtering" title="Permalink to this headline"></a></h2>
<section id="disadvantages-of-the-median-filter">
<h3>Disadvantages of the median filter<a class="headerlink" href="#disadvantages-of-the-median-filter" title="Permalink to this headline"></a></h3>
<p>The median filter is not our spatial filter of choice for two reasons: it does not preserve corners of objects as well as the bilateral filter, and it uses a heuristic method for dealing with the distance noise image. Moreover, the median filter can introduce a bias in the distance image (locally) in some cases, an effect that is not present in the bilateral filter.
We recommend using the <a class="reference internal" href="bilateralFilter.html"><span class="doc std std-doc">bilateral filter</span></a> in most cases.</p>
</section>
<section id="bilateral-and-median-filters-combined">
<h3>Bilateral and median filters combined<a class="headerlink" href="#bilateral-and-median-filters-combined" title="Permalink to this headline"></a></h3>
<p>A combination of both spatial filters is rarely required, and we recommend increasing the filter mask size as a first step. However, if the filtering is not strong enough, then one can use both the bilateral and median filters at the same time. This will further reduce local noise levels but can result in bias in larger noise patterns.</p>
<p>To give you an idea, the image below shows the effect of combined bilateral (<code class="docutils literal notranslate"><span class="pre">anfFilterSizeDiv2=3</span></code>) and median (<code class="docutils literal notranslate"><span class="pre">medianFilterSizeDiv2=2</span></code>) filtering for the example scene.
<img alt="bilateral3_median2" src="../../../../_images/bilateral3_median2.png" /></p>
</section>
</section>
<section id="related-topics">
<h2>Related topics<a class="headerlink" href="#related-topics" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="bilateralFilter.html"><span class="doc std std-doc">Bilateral filter</span></a></p></li>
<li><p><a class="reference internal" href="temporalFilter.html"><span class="doc std std-doc">Temporal filter</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, ifm CSR.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>