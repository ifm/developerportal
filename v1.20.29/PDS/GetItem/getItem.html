<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>getItem &mdash; O3R  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=5800d392" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=d9f55abb"></script>
        <script src="../../_static/js/versionwarning.js?v=d4224a34"></script>
        <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <!-- Google tag (gtag.js) -->
    <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZ08KXKV1G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ZZ08KXKV1G');
    </script> -->
     

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            O3R
          </a>
              <div class="version">
                v1.20.29
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GettingStarted/index_getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Firmware/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CompatibilityMatrix/compatibility_matrix.html">Compatibility Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Technology/index_technology.html">Technology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_software_interfaces.html">Software Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CalibrationRoutines/index_calibrations.html">Calibration Routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ODS/index_ods.html">ODS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_pds.html">PDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PLC/index_plc.html">PLC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../FAQ/FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../downloadable/index.html">History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">O3R</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">getItem</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/PDS/GetItem/getItem.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getitem">
<h1><code class="docutils literal notranslate"><span class="pre">getItem</span></code><a class="headerlink" href="#getitem" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">getItem</span></code> function of PDS is designed to detect the pose of a given item. To do this, PDS requires a template of the item to be detected. A template can be understood as a reference model of the object, consisting of point cloud data from one side of the object, representing the shape of the object as seen from different angles. This template serves as a basis for comparison during the pose detection process.
Please note that these templates typically allow for an angular deviation of up to 10° - 15° from the normal vector.</p>
<p>To detect a custom item, please contact your local ifm support or support.robotics&#64;ifm.com for detailed instructions.</p>
<section id="input">
<h2>Input<a class="headerlink" href="#input" title="Link to this heading"></a></h2>
<section id="command">
<h3>Command<a class="headerlink" href="#command" title="Link to this heading"></a></h3>
<p>The input to the <code class="docutils literal notranslate"><span class="pre">getItem</span></code> command should be provided in JSON.
Below is an example, assuming an instantiated PDS app <code class="docutils literal notranslate"><span class="pre">app0</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;applications&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;instances&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;app0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;configuration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;customization&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;getItem&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;getItem&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nt">&quot;depthHint&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span>
<span class="w">                            </span><span class="nt">&quot;itemIndex&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">                            </span><span class="nt">&quot;itemOrder&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;zAscending&quot;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="depthhint">
<h3><code class="docutils literal notranslate"><span class="pre">depthHint</span></code><a class="headerlink" href="#depthhint" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">depthHint</span></code></p></td>
<td><p>Estimated distance between the item and the calibrated coordinate system center in meters. Set to &lt;=0 for automatic detection.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="itemindex">
<h3><code class="docutils literal notranslate"><span class="pre">itemIndex</span></code><a class="headerlink" href="#itemindex" title="Link to this heading"></a></h3>
<p>The ifm development team developed and tested this functionality on pre-configured trolley types. To detect other types of items, contact ifm support.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">itemIndex</span></code></p></td>
<td><p>Type of the item to be detected.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="itemorder">
<h3><code class="docutils literal notranslate"><span class="pre">itemOrder</span></code><a class="headerlink" href="#itemorder" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">itemOrder</span></code></p></td>
<td><p>When multiple items are detected, the order of the detected items can be set based on the following properties: <br><code class="docutils literal notranslate"><span class="pre">scoreDescending</span></code> (default): the item order will be based upon the detection score (highest to lowest), <br><code class="docutils literal notranslate"><span class="pre">zAscending</span></code> or <code class="docutils literal notranslate"><span class="pre">zDescending</span></code>: the item order will be based upon the height from the floor (<code class="docutils literal notranslate"><span class="pre">zAscending</span></code> - lower to upper, <code class="docutils literal notranslate"><span class="pre">zDescending</span></code> - upper to lower).</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="output">
<h2>Output<a class="headerlink" href="#output" title="Link to this heading"></a></h2>
<p>The output of a <code class="docutils literal notranslate"><span class="pre">getItem</span></code> command is formatted in JSON.
An example JSON result, where the position of one item was identified, is shown below:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;getItem&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;depthEstimationVoi&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;xMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;xMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;yMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;yMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;zMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;zMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;item&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;angles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;rotX&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;rotY&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;rotZ&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.05009809136390686</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;position&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5020731687545776</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.010188048705458641</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;z&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1468670815229416</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9384191036224365</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;projectionVoi&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;xMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;xMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;yMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;yMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;zMax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;zMin&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="item">
<h3><code class="docutils literal notranslate"><span class="pre">item</span></code><a class="headerlink" href="#item" title="Link to this heading"></a></h3>
<p>This component of the JSON result lists out all the detected items (up to 10).
For each item, the following information is provided:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">angles</span></code></p></td>
<td><p>Rotations components <code class="docutils literal notranslate"><span class="pre">rotX</span></code>, <code class="docutils literal notranslate"><span class="pre">rotY</span></code>, <code class="docutils literal notranslate"><span class="pre">rotZ</span></code> of the item, along the three axis of the calibrated coordinate system, in radians.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">position</span></code></p></td>
<td><p>Cartesian coordinates <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">z</span></code> of the item principal point.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">score</span></code></p></td>
<td><p>Detection score of the item [0..1]. Note that the score does <em>not</em> correspond to how well the item is detected but rather how close it is to the reference item template.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="depthestimationvoi-and-projectionvoi">
<h3><code class="docutils literal notranslate"><span class="pre">depthEstimationVoi</span></code> and <code class="docutils literal notranslate"><span class="pre">projectionVoi</span></code><a class="headerlink" href="#depthestimationvoi-and-projectionvoi" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">depthEstimationVoi</span></code> and <code class="docutils literal notranslate"><span class="pre">projectionVoi</span></code> components provide the volumes that were used internally to detect the item:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">depthEstimationVoi</span></code></p></td>
<td><p>Volume used in the algorithm to approximate the position of the front face of the item.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">projectionVoi</span></code></p></td>
<td><p>Area where the precise estimation of the position and rotation of the item was done. The pixels outside this area are discarded.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h2>
<p>To initialize and configure the PDS application to execute <code class="docutils literal notranslate"><span class="pre">getItem</span></code> command, please see the code example below.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">getItem.py</span><a class="headerlink" href="#id1" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1">###########################################</span>
<span class="c1">###2023-present ifm electronic, gmbh</span>
<span class="c1">###SPDX-License-Identifier: Apache-2.0</span>
<span class="c1">###########################################</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Setup:  * Camera: O3R222, 3D on port2</span>
<span class="sd">            * orientation: camera horizontally (FAKRA cable to the left)</span>
<span class="sd">        * Item: item in FoV @ 1.5m distance</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">ifm3dpy.device</span><span class="w"> </span><span class="kn">import</span> <span class="n">O3R</span><span class="p">,</span> <span class="n">Error</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ifm3dpy.framegrabber</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrameGrabber</span><span class="p">,</span> <span class="n">buffer_id</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Device specific configuration</span>
<span class="n">IP</span> <span class="o">=</span> <span class="s2">&quot;192.168.0.69&quot;</span>
<span class="n">CAMERA_PORT</span> <span class="o">=</span> <span class="s2">&quot;port2&quot;</span>
<span class="n">APP_PORT</span> <span class="o">=</span> <span class="s2">&quot;app0&quot;</span>
<span class="n">o3r</span> <span class="o">=</span> <span class="n">O3R</span><span class="p">(</span><span class="n">IP</span><span class="p">)</span>

<span class="c1">############################################</span>
<span class="c1"># Setup the application</span>
<span class="c1">############################################</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">o3r</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="s2">&quot;/applications/instances&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reset failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Set the correct extrinsic calibration of the camera.</span>
<span class="n">calibration</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;transX&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;transY&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;transZ&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="s2">&quot;rotX&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;rotY&quot;</span><span class="p">:</span> <span class="mf">1.57</span><span class="p">,</span>
    <span class="s2">&quot;rotZ&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.57</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting the extrinsic calibration for camera in </span><span class="si">{</span><span class="n">CAMERA_PORT</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">o3r</span><span class="o">.</span><span class="n">set</span><span class="p">({</span><span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">CAMERA_PORT</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;processing&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;extrinsicHeadToUser&quot;</span><span class="p">:</span> <span class="n">calibration</span><span class="p">}}}})</span>

<span class="c1"># Create the application instance and set to IDLE (ready to be triggered)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Create a PDS instance using camera in </span><span class="si">{</span><span class="n">CAMERA_PORT</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">o3r</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;applications&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">APP_PORT</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;pds&quot;</span><span class="p">,</span> <span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">CAMERA_PORT</span><span class="p">],</span> <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;IDLE&quot;</span><span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1">############################################</span>
<span class="c1"># Setup the framegrabber to receive frames</span>
<span class="c1"># when the application is triggered.</span>
<span class="c1">############################################</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">FrameGrabber</span><span class="p">(</span><span class="n">o3r</span><span class="p">,</span> <span class="n">o3r</span><span class="o">.</span><span class="n">port</span><span class="p">(</span><span class="n">APP_PORT</span><span class="p">)</span><span class="o">.</span><span class="n">pcic_port</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">start</span><span class="p">([</span><span class="n">buffer_id</span><span class="o">.</span><span class="n">O3R_RESULT_JSON</span><span class="p">])</span>


<span class="c1"># Define a callback function to be executed every time a frame is received</span>
<span class="k">def</span><span class="w"> </span><span class="nf">item_callback</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Callback function executed every time a frame is received.</span>
<span class="sd">    The data is decoded and the result printed.</span>

<span class="sd">    :param frame: A frame containing the data for all the buffer ids</span>
<span class="sd">    requested in the start function of the framegrabber.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">frame</span><span class="o">.</span><span class="n">has_buffer</span><span class="p">(</span><span class="n">buffer_id</span><span class="o">.</span><span class="n">O3R_RESULT_JSON</span><span class="p">):</span>
        <span class="n">json_chunk</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">get_buffer</span><span class="p">(</span><span class="n">buffer_id</span><span class="o">.</span><span class="n">O3R_RESULT_JSON</span><span class="p">)</span>
        <span class="n">json_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">json_chunk</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="n">json_array</span> <span class="o">=</span> <span class="n">json_array</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
        <span class="n">parsed_json_array</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_array</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detected item: </span><span class="si">{</span><span class="n">parsed_json_array</span><span class="p">[</span><span class="s1">&#39;getItem&#39;</span><span class="p">][</span><span class="s1">&#39;item&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="n">fg</span><span class="o">.</span><span class="n">on_new_frame</span><span class="p">(</span><span class="n">item_callback</span><span class="p">)</span>

<span class="c1">############################################</span>
<span class="c1"># Trigger the getItem command</span>
<span class="c1">############################################</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Grace period after the framegrabber starts</span>

<span class="n">GET_ITEM_PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;depthHint&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Estimated position of the item (-1 for automatic detection)</span>
    <span class="s2">&quot;itemIndex&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Type of item</span>
<span class="p">}</span>

<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Triggering the getItem command&quot;</span><span class="p">)</span>
<span class="n">o3r</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;applications&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">APP_PORT</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;configuration&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;customization&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;getItem&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;getItem&quot;</span><span class="p">:</span> <span class="n">GET_ITEM_PARAMETERS</span><span class="p">,</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Allow time for the callback to execute before exiting</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          
<html>
<head>
 
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="keywords" content="footer, address, phone, icons" />
 
	<title>Footer With Address And Phones</title>
	
	
 
</head>
 
	<body>
		
		<footer class="footer-distributed">
 
		<div class="footer-left">
 
		<p class="footer-links">
		<a href="index.html">Home</a>
	·
		<a href="http://www.o3r.ifm" target="_blank">Learn more</a>
	·
		<a href="/latest/_static/privacy-policy.html" target="_blank">Privacy Policy</a>

		</p>
 
		<p class="footer-company-name">ifm robotics &copy; 2023</p>
		</div>
		
		<div class="footer-center">
 
		<div>
		<i class="fa fa-envelope"></i>
		<p><a href="mailto:support.efector.object-ident@ifm.com">support.efector.object-ident@ifm.com</a></p>
		</div>
 
		</div>
 
		<div class="footer-right">
 
		<div class="footer-icons">
 
		<a href="https://www.facebook.com/ifmefector" target="_blank"><i class="fa fa-facebook"></i></a>
		<a href="https://twitter.com/ifm_USA" target="_blank"><i class="fa fa-twitter"></i></a>
		<a href="https://www.linkedin.com/showcase/ifm-efector" target="_blank"><i class="fa fa-linkedin"></i></a>
		<a href="https://github.com/ifm" target="_blank"><i class="fa fa-github"></i></a>
 
		</div>
 
		</div>
 
		</footer>
 
	</body>
 
</html>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>